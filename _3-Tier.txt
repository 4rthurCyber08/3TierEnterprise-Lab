
Secret: pass

1. Identify ports using CDP or LLDP

!@Device
show cdp neighbor

2. Create VLAN 120, named DATA.

3. Configure 802.1q between switches. Allow all VLANs. Specify DATA VLAN as untagged.

!@C1, C2
conf t
 int range e0/1-3
  description Connection to C2
 int range e1/1-2
  description Connection to D1
 int range e2/1-2
  description Connection to D2
  exit
 !
 int range e0/1-3,e1/1-2,e2/1-2
  switchport trunk encaps dot1q
  switchport mode trunk
  switchport trunk allowed vlan all
  switchport trunk native vlan 120
  end

!@D1, D2
conf t
 int range e1/0,e1/3
  description Connection to C1
 int range e2/0,e2/3
  description Connection to C2
 int range e1/1-2
  description Connection to A1
 int range e2/1-2
  description Connection to A2
 int range e3/1-2
  description Connection to A3
  exit
 !
 int range e1/0-3,e2/0-3,e3/1-2
  switchport trunk encaps dot1q
  switchport mode trunk
  switchport trunk allowed vlan all
  switchport trunk native vlan 120
  end
  
!@A1,A2,A3
conf t
 int range e1/1-2
  description Connection to D1
 int range e2/1-2
  description Connection to D2
  exit
 !
 int range e1/1-2,e2/1-2
  switchport trunk encaps dot1q
  switchport mode trunk
  switchport trunk allowed vlan all
  switchport trunk native vlan 120
  end


4. Configure VTP Domain CCNP on all Switches
- VTP Version 2
- VTP mode server (C1, C2) client (D1, D2, A1, A2, A3, A4)
- VTP password C1sc0123

!@C1,C2
conf t
 vtp version 2
 vtp mode server
 vtp domain CCNP
 vtp password C1sc0123
 end

!@D1,D2,A1,A2,A3,A4
conf t
 vtp version 2
 vtp mode client
 vtp domain CCNP
 vtp password C1sc0123
 end

5. Verify by creating VLANs 12 (NETWORK) & 13 (SECURITY)

!@C1 or C2
conf t
 vlan 12
  name NETWORK
  exit
 vlan 13
  name SECURITY
  exit
  end

!@A3
show vlan brief


6. WARNING, Dangers of VTP Revision Number

!@A4
conf t
 vtp mode server
 vlan 2
  name -T
 vlan 3
  name E
 vlan 4
  name S
 vlan 5
  name T
 vlan 6
  name I
 vlan 7
  name N
 vlan 8
  name G-
  end
show vtp status


Add A4 to the network

!@A3,A4
conf t
 int e0/3
  no shut
  end
  
Check C1 & C2 for VLANs

!@C1,C2
show vlan brief


Set A4's Revision Number to 0

!@A4
conf t
 vtp mode transparent
 end
show vtp status


7. Fix the VLANs by configuring VTP Version 3

!@C1,C2
conf t
 vtp version 3
 vtp mode server
 end
vtp primary

!@A4
conf t
 no vlan 2
 no vlan 3
 no vlan 4
 no vlan 5
 no vlan 6
 no vlan 7
 no vlan 8
 end

vs

!@C1
conf t
 no vlan 2
 no vlan 3
 no vlan 4
 no vlan 5
 no vlan 6
 no vlan 7
 no vlan 8
 end

!@D1,D2,A1,A2,A3,A4
conf t
 vtp version 3
 end
show vlan brief


Finally, Configure the VLANs

!@C1 or C2
conf t
 vlan 10
 name ADMIN
!
vlan 20
 name FINANCE
!
vlan 30
 name HR
!
vlan 40
 name MARKETING
!
vlan 41
 name Public Relations
!
vlan 42
 name SocMed
!
vlan 50
 name SALES
!
vlan 60
 name IT
!
vlan 61
 name Systems
!
vlan 62
 name Network
!
vlan 100
 name ServerFarm
!
vlan 120
 name DATA
!
vlan 11
 name NETWORK
!
vlan 12
 name SECURITY
 end
 



8. Configure Etherchannel

C1-C2 = Po102
C1-D1 = Po11
C1-D2 = Po12
C2-D1 = Po21
C2-D2 = Po22

D1-A1 = Po111
D1-A2 = Po112
D1-A3 = Po113

D2-A1 = Po221
D2-A2 = Po222
D2-A3 = Po223

!@C1
conf t
 int range e0/1-3
  channel-group 102 mode active
  channel-protocol lacp
  exit
 int range e1/1-2
  channel-group 11 mode active
  channel-protocol lacp
  exit
 int range e2/1-2
  channel-group 12 mode active
  channel-protocol lacp
  exit

!@C2
conf t
 int range e0/1-3
  channel-group 102 mode active
  channel-protocol lacp
  exit
 int range e1/1-2
  channel-group 21 mode active
  channel-protocol lacp
  exit
 int range e2/1-2
  channel-group 22 mode active
  channel-protocol lacp
  exit
  
!@D1
conf t
 int range e1/0,e1/3
  channel-group 11 mode passive
  channel-protocol lacp
 int range e2/0,e2/3
  channel-group 21 mode passive
  channel-protocol lacp
 int range e1/1-2
  channel-group 111 mode active
  channel-protocol lacp
 int range e2/1-2
  channel-group 112 mode active
  channel-protocol lacp
 int range e3/1-2
  channel-group 113 mode active
  channel-protocol lacp
  end

!@D2
conf t
 int range e1/0,e1/3
  channel-group 12 mode passive
  channel-protocol lacp
 int range e2/0,e2/3
  channel-group 22 mode passive
  channel-protocol lacp
 int range e1/1-2
  channel-group 221 mode active
  channel-protocol lacp
 int range e2/1-2
  channel-group 222 mode active
  channel-protocol lacp
 int range e3/1-2
  channel-group 223 mode active
  channel-protocol lacp
  end

!@A1
conf t
 int range e1/1-2
  channel-group 111 mode active
  channel-protocol lacp
 int range e2/1-2
  channel-group 221 mode active
  channel-protocol lacp
  end

!@A2
conf t
 int range e1/1-2
  channel-group 112 mode active
  channel-protocol lacp
 int range e2/1-2
  channel-group 222 mode active
  channel-protocol lacp
  end

!@A3
conf t
 int range e1/1-2
  channel-group 113 mode active
  channel-protocol lacp
 int range e2/1-2
  channel-group 223 mode active
  channel-protocol lacp
  end
